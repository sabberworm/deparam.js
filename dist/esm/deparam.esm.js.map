{"version":3,"file":"deparam.esm.js","sources":["../../node_modules/is-number/index.js","../../src/deparam.js"],"sourcesContent":["/*!\n * is-number <https://github.com/jonschlinkert/is-number>\n *\n * Copyright (c) 2014-present, Jon Schlinkert.\n * Released under the MIT License.\n */\n\n'use strict';\n\nmodule.exports = function(num) {\n  if (typeof num === 'number') {\n    return num - num === 0;\n  }\n  if (typeof num === 'string' && num.trim() !== '') {\n    return Number.isFinite ? Number.isFinite(+num) : isFinite(+num);\n  }\n  return false;\n};\n","import isNumber from 'is-number';\n\n// Vars\nconst isBrowser = typeof window !== 'undefined';\n\n// Shorthand for built-ins\nconst isArr = Array.isArray;\n\nfunction hasOwn(obj, key) {\n  return Object.prototype.hasOwnProperty.call(obj, key);\n}\n\n/**\n * Checks if key is a true object\n * @param {*} key Any type of value\n */\nfunction isObject(key) {\n  return typeof key === 'object' && key !== null && !isArr(key);\n}\n\n/**\n * Checks if query parameter key is a complex notation\n * @param {string} q\n */\nfunction ifComplex(q) {\n  return /\\[/.test(q);\n}\n\n/**\n * Converts query string to JavaScript object\n * @param {string} qs query string argument (defaults to url query string)\n */\nfunction deparam(qs = isBrowser ? location.search : '', coerce = false) {\n  qs = qs.substring(qs.charAt(0) === '?');\n  const queryParamList = qs.split('&');\n  const queryObject = {};\n  if (qs) {\n    queryParamList.forEach((qq) => {\n      const qArr = qq.split('=').map((part) => decodeURIComponent(part));\n      if (ifComplex(qArr[0])) {\n        complex.apply(this, [].concat(qArr).concat([queryObject, coerce]));\n      } else {\n        simple.apply(this, [qArr, queryObject, false, coerce]);\n      }\n    });\n  }\n  return queryObject;\n}\n\n/**\n * Converts an array to an object\n * @param {array} arr\n */\nfunction toObject(arr) {\n  var convertedObj = Object.create(null);\n  if (isArr(arr)) {\n    arr.forEach((value, index) => {\n      convertedObj[index] = value;\n    });\n  }\n  return convertedObj;\n}\n\n/**\n * Resolves an array to object if required\n * @param {array} ob An array object\n * @param {boolean} isNumber flag to test if next key is number\n */\nfunction resolve(ob, isNextNumber) {\n  if (typeof ob === 'undefined') return isNextNumber ? [] : Object.create(null);\n  return isNextNumber ? ob : toObject(ob);\n}\n\n/**\n * Resolves the target object for next iteration\n * @param {Object} ob current reference object\n * @param {string} nextProp reference property in current object\n */\nfunction resolveObj(ob, nextProp) {\n  if (isObject(ob)) return { ob };\n  if (isArr(ob) || typeof ob === 'undefined')\n    return { ob: resolve(ob, isNumber(nextProp)) };\n  return { ob: [ob], push: ob !== null };\n}\n\n/**\n * Handles complex query parameters\n * @param {string} key\n * @param {string} value\n * @param {Object} obj\n */\nfunction complex(key, value, obj, doCoerce) {\n  const match = key.match(/([^\\[]+)\\[([^\\[]*)\\]/) || [];\n  if (match.length === 3) {\n    let prop = match[1];\n    let nextProp = match[2];\n    key = key.replace(/\\[([^\\[]*)\\]/, '');\n    if (ifComplex(key)) {\n      if (nextProp === '') nextProp = '0';\n      key = key.replace(/[^\\[]+/, nextProp);\n      complex(\n        key,\n        value,\n        (obj[prop] = resolveObj(obj[prop], nextProp).ob),\n        doCoerce\n      );\n    } else if (nextProp) {\n      const { ob, push } = resolveObj(obj[prop], nextProp);\n      obj[prop] = ob;\n      const nextOb = push ? {} : obj[prop];\n      nextOb[nextProp] = coerce(value, !doCoerce);\n      if (push) {\n        obj[prop].push(nextOb);\n      }\n    } else {\n      simple([match[1], value], obj, true, doCoerce);\n    }\n  }\n}\n\n/**\n * Handles simple query\n * @param {array} qArr\n * @param {Object} queryObject\n * @param {boolean} toArray\n */\nfunction simple(qArr, queryObject, toArray, doCoerce) {\n  let key = qArr[0];\n  let value = qArr[1];\n  value = coerce(value, !doCoerce);\n  if (hasOwn(queryObject, key)) {\n    queryObject[key] = isArr(queryObject[key])\n      ? queryObject[key]\n      : [queryObject[key]];\n    queryObject[key].push(value);\n  } else {\n    queryObject[key] = toArray ? [value] : value;\n  }\n}\n\n/**\n * Restores values to their original type\n * @param {string} value undefined or string value\n */\nfunction coerce(value, skip) {\n  if (value == null) return '';\n  if (skip || typeof value !== 'string') return value;\n  value = value.trim();\n  if (isNumber(value)) return +value;\n  switch (value) {\n    case 'null':\n      return null;\n    case 'undefined':\n      return undefined;\n    case 'true':\n      return true;\n    case 'false':\n      return false;\n    case 'NaN':\n      return NaN;\n    default:\n      return value;\n  }\n}\n\n// Library encapsulation\nfunction lib() {\n  return deparam.apply(this, arguments);\n}\n\nexport default lib;\n"],"names":["isBrowser","window","isArr","Array","isArray","hasOwn","obj","key","Object","prototype","hasOwnProperty","call","isObject","ifComplex","q","test","deparam","qs","location","search","coerce","substring","charAt","queryParamList","split","queryObject","forEach","qq","qArr","map","part","decodeURIComponent","complex","apply","concat","simple","toObject","arr","convertedObj","create","value","index","resolve","ob","isNextNumber","resolveObj","nextProp","isNumber","push","doCoerce","match","length","prop","replace","nextOb","toArray","skip","trim","undefined","NaN","lib","arguments"],"mappings":"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"}